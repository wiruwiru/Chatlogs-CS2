(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[212],{2622:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/chatlog",function(){return t(8970)}])},197:(e,a,t)=>{"use strict";t.d(a,{S:()=>g});var r=t(4848),s=t(6540),n=t(9611),l=t(9096),o=t(9751),d=t(5126),c=t(9242),i=t(7049);function u(e){let{className:a,classNames:t,showOutsideDays:s=!0,...n}=e;return(0,r.jsx)(c.hv,{showOutsideDays:s,className:(0,o.cn)("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,o.cn)((0,d.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:(0,o.cn)("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md","range"===n.mode?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:(0,o.cn)((0,d.r)({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:e=>{let{className:a,...t}=e;return(0,r.jsx)(i.YJP,{className:(0,o.cn)("h-4 w-4",a),...t})},IconRight:e=>{let{className:a,...t}=e;return(0,r.jsx)(i.vKP,{className:(0,o.cn)("h-4 w-4",a),...t})}},...n})}u.displayName="Calendar";var m=t(9823);let x=m.bL,f=m.l9;m.Mz;let h=s.forwardRef((e,a)=>{let{className:t,align:s="center",sideOffset:n=4,...l}=e;return(0,r.jsx)(m.ZL,{children:(0,r.jsx)(m.UC,{ref:a,align:s,sideOffset:n,className:(0,o.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})})});function g(e){let{className:a,value:t,onChange:s}=e;return(0,r.jsx)("div",{className:(0,o.cn)("grid gap-2",a),children:(0,r.jsxs)(x,{children:[(0,r.jsx)(f,{asChild:!0,children:(0,r.jsxs)(d.$,{id:"date",variant:"outline",className:(0,o.cn)("w-full justify-start text-left font-normal",!t&&"text-muted-foreground","bg-secondary text-foreground border-input hover:bg-background hover:text-accent-foreground"),children:[(0,r.jsx)(l.A,{className:"mr-2 h-4 w-4"}),(null==t?void 0:t.from)?t.to?(0,r.jsxs)(r.Fragment,{children:[(0,n.GP)(t.from,"LLL dd, y")," -"," ",(0,n.GP)(t.to,"LLL dd, y")]}):(0,n.GP)(t.from,"LLL dd, y"):(0,r.jsx)("span",{children:"Pick a date range"})]})}),(0,r.jsx)(h,{className:"w-auto p-0",align:"start",children:(0,r.jsx)(u,{initialFocus:!0,mode:"range",defaultMonth:null==t?void 0:t.from,selected:t,onSelect:s,numberOfMonths:2,className:"bg-background text-foreground border-border"})})]})})}h.displayName=m.UC.displayName},8718:(e,a,t)=>{"use strict";t.d(a,{Eb:()=>m,Iu:()=>c,M_:()=>f,WA:()=>x,cU:()=>i,dK:()=>d,n$:()=>u});var r=t(4848),s=t(6540),n=t(9751),l=t(5126),o=t(7049);let d=e=>{let{className:a,...t}=e;return(0,r.jsx)("nav",{role:"navigation","aria-label":"pagination",className:(0,n.cn)("mx-auto flex w-full justify-center",a),...t})};d.displayName="Pagination";let c=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("ul",{ref:a,className:(0,n.cn)("flex flex-row items-center gap-1",t),...s})});c.displayName="PaginationContent";let i=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("li",{ref:a,className:(0,n.cn)("",t),...s})});i.displayName="PaginationItem";let u=e=>{let{className:a,isActive:t,size:s="icon",...o}=e;return(0,r.jsx)("a",{"aria-current":t?"page":void 0,className:(0,n.cn)((0,l.r)({variant:t?"outline":"ghost",size:s}),a),...o})};u.displayName="PaginationLink";let m=e=>{let{className:a,...t}=e;return(0,r.jsxs)(u,{"aria-label":"Go to previous page",size:"default",className:(0,n.cn)("gap-1 pl-2.5",a),...t,children:[(0,r.jsx)(o.YJP,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Previous"})]})};m.displayName="PaginationPrevious";let x=e=>{let{className:a,...t}=e;return(0,r.jsxs)(u,{"aria-label":"Go to next page",size:"default",className:(0,n.cn)("gap-1 pr-2.5",a),...t,children:[(0,r.jsx)("span",{children:"Next"}),(0,r.jsx)(o.vKP,{className:"h-4 w-4"})]})};x.displayName="PaginationNext";let f=e=>{let{className:a,...t}=e;return(0,r.jsxs)("span",{"aria-hidden":!0,className:(0,n.cn)("flex h-9 w-9 items-center justify-center",a),...t,children:[(0,r.jsx)(o.Oer,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"More pages"})]})};f.displayName="PaginationEllipsis"},4111:(e,a,t)=>{"use strict";t.d(a,{T:()=>l});var r=t(4848),s=t(6540),n=t(8718);function l(e){let{currentPage:a,totalPages:t,onPageChange:l,className:o}=e,d=!function(e){let[a,t]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let r=window.matchMedia(e);r.matches!==a&&t(r.matches);let s=()=>t(r.matches);return r.addEventListener("change",s),()=>r.removeEventListener("change",s)},[a,e]),a}("(max-width: 640px)")?5:3;return(0,r.jsx)(n.dK,{className:o,children:(0,r.jsxs)(n.Iu,{className:"gap-1",children:[(0,r.jsx)(n.cU,{children:(0,r.jsx)(n.Eb,{onClick:()=>l(Math.max(1,a-1)),className:"h-8 bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",disabled:1===a})}),(()=>{let e=[],s=Math.max(1,a-Math.floor(d/2)),o=Math.min(t,s+d-1);o-s+1<d&&(s=Math.max(1,o-d+1)),s>1&&(e.push((0,r.jsx)(n.cU,{children:(0,r.jsx)(n.n$,{onClick:()=>l(1),className:"bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",children:"1"})},"start")),s>2&&e.push((0,r.jsx)(n.cU,{children:(0,r.jsx)(n.M_,{className:"bg-background text-foreground border-border"})},"start-ellipsis")));for(let t=s;t<=o;t++)e.push((0,r.jsx)(n.cU,{children:(0,r.jsx)(n.n$,{onClick:()=>l(t),isActive:a===t,className:a===t?"bg-accent text-accent-foreground border-border":"bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",children:t})},t));return o<t&&(o<t-1&&e.push((0,r.jsx)(n.cU,{children:(0,r.jsx)(n.M_,{className:"bg-background text-foreground border-border"})},"end-ellipsis")),e.push((0,r.jsx)(n.cU,{children:(0,r.jsx)(n.n$,{onClick:()=>l(t),className:"bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",children:t})},"end"))),e})(),(0,r.jsx)(n.cU,{children:(0,r.jsx)(n.WA,{onClick:()=>l(Math.min(t,a+1)),className:"h-8 bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",disabled:a===t})})]})})}},778:(e,a,t)=>{"use strict";t.d(a,{bq:()=>i,eb:()=>f,gC:()=>x,l6:()=>d,yv:()=>c});var r=t(4848),s=t(6540),n=t(5136),l=t(9751),o=t(7049);let d=n.bL;n.YJ;let c=n.WT,i=s.forwardRef((e,a)=>{let{className:t,children:s,...d}=e;return(0,r.jsxs)(n.l9,{ref:a,className:(0,l.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...d,children:[s,(0,r.jsx)(n.In,{asChild:!0,children:(0,r.jsx)(o.D3D,{className:"h-4 w-4 opacity-50"})})]})});i.displayName=n.l9.displayName;let u=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(n.PP,{ref:a,className:(0,l.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(o.Mtm,{className:"h-4 w-4"})})});u.displayName=n.PP.displayName;let m=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(n.wn,{ref:a,className:(0,l.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,r.jsx)(o.D3D,{className:"h-4 w-4"})})});m.displayName=n.wn.displayName;let x=s.forwardRef((e,a)=>{let{className:t,children:s,position:o="popper",...d}=e;return(0,r.jsx)(n.ZL,{children:(0,r.jsxs)(n.UC,{ref:a,className:(0,l.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===o&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:o,...d,children:[(0,r.jsx)(u,{}),(0,r.jsx)(n.LM,{className:(0,l.cn)("p-1","popper"===o&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(m,{})]})})});x.displayName=n.UC.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(n.JU,{ref:a,className:(0,l.cn)("px-2 py-1.5 text-sm font-semibold",t),...s})}).displayName=n.JU.displayName;let f=s.forwardRef((e,a)=>{let{className:t,children:s,...d}=e;return(0,r.jsxs)(n.q7,{ref:a,className:(0,l.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...d,children:[(0,r.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(n.VF,{children:(0,r.jsx)(o.Srz,{className:"h-4 w-4"})})}),(0,r.jsx)(n.p4,{children:s})]})});f.displayName=n.q7.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(n.wv,{ref:a,className:(0,l.cn)("-mx-1 my-1 h-px bg-muted",t),...s})}).displayName=n.wv.displayName},8970:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>v});var r=t(4848),s=t(6540),n=t(6715),l=t(2474),o=t(6424),d=t(8435),c=t(172),i=t(8353),u=t(778),m=t(3761),x=t(9893),f=t(2955),h=t(5126),g=t(197),p=t(4111),b=t(2510);function j(){let{toast:e}=(0,b.dj)(),a=(0,o.useRouter)(),t=(0,o.useSearchParams)(),n=t.get("page"),[l,j]=(0,s.useState)([]),[v,N]=(0,s.useState)("all"),[y,w]=(0,s.useState)(""),[S,k]=(0,s.useState)("all"),[_,P]=(0,s.useState)(""),[C,E]=(0,s.useState)(n?parseInt(n):1),[L,I]=(0,s.useState)(1),[M,U]=(0,s.useState)(!1),[R,z]=(0,s.useState)(!0),[F,O]=(0,s.useState)({}),[A,T]=(0,s.useState)(void 0),[D,G]=(0,s.useState)([]),q=async()=>{try{let e=await fetch("/api/admin/config"),a=await e.json(),t=JSON.parse(a.SERVER_OPTIONS||"[]");G(t)}catch(a){console.error("Error fetching server options:",a),e({title:"Error",description:"Failed to load server options",variant:"destructive"})}},J=async a=>{try{let e=await fetch("/api/steam/profiles?ids=".concat(a.join(",")));if(!e.ok)throw Error("Failed to fetch Steam profiles");let t=await e.json();O(e=>({...e,...t}))}catch(a){console.error("Error fetching Steam profiles:",a),e({title:"Error",description:"Failed to load Steam profiles",variant:"destructive"})}},$=(0,s.useCallback)(async a=>{U(!0);try{let e=new URLSearchParams({page:a.toString(),..."all"!==v&&{serverId:v},...y&&{steamIdNameIpFilter:y},..."all"!==S&&{team:S},..._&&{message:_},...(null==A?void 0:A.from)&&{fromDate:A.from.toISOString()},...(null==A?void 0:A.to)&&{toDate:A.to.toISOString()}}),t=await fetch("/api/chatlogs/chatcstwo?".concat(e));if(!t.ok)throw Error("Failed to fetch messages");let r=await t.json();j(r.items),I(r.totalPages);let s=[...new Set(r.items.map(e=>e.playerSteam64))];s.length>0&&J(s)}catch(a){console.error("Error fetching messages:",a),e({title:"Error",description:"Failed to load messages",variant:"destructive"})}finally{U(!1)}},[v,y,S,_,A]);(0,s.useEffect)(()=>{q()},[]),(0,s.useEffect)(()=>{E(1),$(1)},[v,y,S,_,A,$]),(0,s.useEffect)(()=>{let e=t.get("page");e&&E(parseInt(e)),$(C)},[t,C,$]);let K=e=>{switch(e.toString()){case"0":return"bg-red-500";case"1":return"bg-blue-500";default:return"bg-gray-500"}},V=e=>{switch(e.toString()){case"0":return"Global";case"1":return"Team";default:return"Unknown"}},W=e=>{a.push("/chatlog/".concat(e))};return(0,r.jsxs)(c.Zp,{className:"max-w-6xl mx-auto bg-background shadow-lg border-border",children:[(0,r.jsxs)(c.aR,{className:"flex flex-row items-center justify-between border-b border-border",children:[(0,r.jsx)(c.ZB,{className:"text-foreground text-2xl font-bold",children:"Chat Logs"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(h.$,{onClick:()=>{$(C)},variant:"outline",size:"icon",className:"bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",children:(0,r.jsx)(m.A,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>z(!R),className:"p-2 hover:bg-background rounded-full transition-colors",children:(0,r.jsx)(x.A,{className:"h-5 w-5 text-foreground"})})]})]}),(0,r.jsxs)(c.Wu,{className:"p-4",children:[R&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,r.jsxs)(u.l6,{value:v,onValueChange:N,children:[(0,r.jsx)(u.bq,{className:"bg-secondary text-foreground border-input",children:(0,r.jsx)(u.yv,{placeholder:"Select Server"})}),(0,r.jsxs)(u.gC,{className:"bg-background border-border",children:[(0,r.jsx)(u.eb,{value:"all",className:"text-foreground",children:"All Servers"}),D.map(e=>(0,r.jsx)(u.eb,{value:e.value,className:"text-foreground",children:e.label},e.value))]})]}),(0,r.jsxs)(u.l6,{value:S,onValueChange:k,children:[(0,r.jsx)(u.bq,{className:"bg-secondary text-foreground border-input",children:(0,r.jsx)(u.yv,{placeholder:"Select Team"})}),(0,r.jsx)(u.gC,{className:"bg-background border-border",children:[{value:"all",label:"All Chats"},{value:"0",label:"Global Message"},{value:"1",label:"Team Message"}].map(e=>(0,r.jsx)(u.eb,{value:e.value,className:"text-foreground",children:e.label},e.value))})]}),(0,r.jsx)(g.S,{value:A,onChange:e=>{T(e),E(1),$(1)},className:"col-span-1"}),(0,r.jsx)(d.p,{placeholder:"Filter by Steam ID, Name, or IP",value:y,onChange:e=>w(e.target.value),className:"bg-secondary text-foreground border-input col-span-1"}),(0,r.jsx)(d.p,{placeholder:"Filter by Message",value:_,onChange:e=>P(e.target.value),className:"bg-secondary text-foreground border-input col-span-2"})]}),(0,r.jsx)("div",{className:"space-y-4",children:M?(0,r.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,r.jsx)(f.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):l.map((e,a)=>{var t,s,n;return(0,r.jsx)("div",{className:"flex ".concat(a%2==0?"justify-start":"justify-end"),children:(0,r.jsxs)("div",{className:"flex items-start space-x-2 max-w-[80%] ".concat(a%2==0?"flex-row":"flex-row-reverse"),children:[(0,r.jsxs)(i.eu,{className:"h-10 w-10 border border-border cursor-pointer",onClick:()=>W(e.playerSteam64),children:[(0,r.jsx)(i.BK,{src:null===(t=F[e.playerSteam64])||void 0===t?void 0:t.avatarUrl,alt:e.playerName}),(0,r.jsx)(i.q5,{className:"bg-foreground text-muted-foreground",children:e.playerName.slice(0,2)})]}),(0,r.jsxs)("div",{className:"flex flex-col ".concat(a%2==0?"items-start":"items-end"),children:[(0,r.jsx)("span",{className:"font-medium text-sm text-foreground cursor-pointer",onClick:()=>W(e.playerSteam64),children:(null===(s=F[e.playerSteam64])||void 0===s?void 0:s.displayName)||e.playerName}),(0,r.jsx)("div",{className:"mt-1 rounded-lg p-3 shadow-sm ".concat(K(e.team)," text-white"),children:(0,r.jsx)("p",{className:"text-sm",children:e.message})}),(0,r.jsxs)("div",{className:"mt-1 flex items-center space-x-2 text-xs text-muted-foreground",children:[(0,r.jsx)("span",{children:V(e.team)}),(0,r.jsx)("span",{children:(null===(n=D.find(a=>a.value===e.serverId))||void 0===n?void 0:n.label)||"Unknown"}),(0,r.jsx)("span",{children:e.created}),(0,r.jsxs)("span",{children:["IP: ",e.lastIP||"Unknown"]})]})]})]})},e.id)})}),(0,r.jsx)(p.T,{currentPage:C,totalPages:L,onPageChange:e=>{E(e),a.push("/chatlog?page=".concat(e),void 0,{shallow:!0}),window.scrollTo(0,0)},className:"mt-6"})]})]})}function v(){let[e,a]=(0,s.useState)(null),[t,o]=(0,s.useState)(!0),d=(0,n.useRouter)();return((0,s.useEffect)(()=>{(async function(){try{let e=await fetch("/api/auth/session"),t=await e.json();t.user?a(t.user):d.push("/login")}catch(e){console.error("Error fetching user:",e),d.push("/login")}finally{o(!1)}})()},[d]),t)?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,r.jsx)("div",{className:"text-2xl font-semibold text-foreground",children:"Loading..."})}):e?(0,r.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,r.jsx)(l.A,{}),(0,r.jsx)("div",{className:"p-8",children:(0,r.jsx)(j,{})})]}):null}}},e=>{var a=a=>e(e.s=a);e.O(0,[111,518,456,890,636,593,792],()=>a(2622)),_N_E=e.O()}]);