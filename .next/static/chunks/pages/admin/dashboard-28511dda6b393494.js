(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[36],{4258:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/dashboard",function(){return a(8061)}])},710:(e,s,a)=>{"use strict";a.d(s,{A:()=>i});var r=a(4848),t=a(1106),l=a.n(t);function i(){return(0,r.jsx)("footer",{className:"py-6 text-center border-t border-border",children:(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,r.jsx)(l(),{href:"/",className:"hover:text-primary transition-colors",children:"ChatPanel"})," Copyright 2024 \xa9 | Design by ",(0,r.jsx)(l(),{href:"https://lucauy.dev",target:"_blank",rel:"nofollow",className:"hover:text-primary transition-colors",children:"Luca."})]})})}},8353:(e,s,a)=>{"use strict";a.d(s,{BK:()=>c,eu:()=>n,q5:()=>o});var r=a(4848),t=a(6540),l=a(5847),i=a(9751);let n=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l.bL,{ref:s,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...t})});n.displayName=l.bL.displayName;let c=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l._V,{ref:s,className:(0,i.cn)("aspect-square h-full w-full",a),...t})});c.displayName=l._V.displayName;let o=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l.H4,{ref:s,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...t})});o.displayName=l.H4.displayName},7666:(e,s,a)=>{"use strict";a.d(s,{Xi:()=>o,av:()=>d,j7:()=>c,tU:()=>n});var r=a(4848),t=a(6540),l=a(2534),i=a(9751);let n=l.bL,c=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l.B8,{ref:s,className:(0,i.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),...t})});c.displayName=l.B8.displayName;let o=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l.l9,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",a),...t})});o.displayName=l.l9.displayName;let d=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l.UC,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...t})});d.displayName=l.UC.displayName},8061:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>g});var r=a(4848),t=a(6540),l=a(6715),i=a(4862),n=a(5126),c=a(8435),o=a(778),d=a(8353),u=a(2955),m=a(3004),h=a(8097),f=a(710),x=a(7666),p=a(172),v=a(2510);function g(){var e;let{toast:s}=(0,v.dj)(),[a,g]=(0,t.useState)(null),[j,N]=(0,t.useState)([]),[y,w]=(0,t.useState)(""),[b,E]=(0,t.useState)("user"),[S,R]=(0,t.useState)(!0),[_,O]=(0,t.useState)(null),[U,k]=(0,t.useState)({}),[I,C]=(0,t.useState)({}),[A,T]=(0,t.useState)({IMAGE_URL:"",SERVER_OPTIONS:[]}),P=(0,l.useRouter)(),V=async e=>{try{let s=await fetch("/api/steam/profiles?ids=".concat(e.join(",")));if(!s.ok)throw Error("Failed to fetch Steam profiles");let a=await s.json();k(e=>({...e,...a}))}catch(e){console.error("Error fetching Steam profiles:",e),O("Failed to fetch user profiles. Please try again later.")}},L=async()=>{try{let e=await fetch("/api/admin/authorized-users");if(!e.ok)throw Error("Failed to fetch authorized users");let s=await e.json();N(s.users||[]);let a=s.users.map(e=>e.steam_id);await V(a)}catch(e){console.error("Error fetching authorized users:",e),O("Failed to fetch authorized users. Please try again later.")}},F=async()=>{try{let e=await fetch("/api/admin/config");if(!e.ok)throw Error("Failed to fetch configuration");let s=await e.json();C(s),T({IMAGE_URL:s.IMAGE_URL||"",SERVER_OPTIONS:JSON.parse(s.SERVER_OPTIONS||"[]")})}catch(e){console.error("Error fetching configuration:",e),O("Failed to fetch configuration. Please try again later.")}};(0,t.useEffect)(()=>{!async function(){try{R(!0);let e=await fetch("/api/auth/session");if(!e.ok)throw Error("Failed to fetch user session");let s=await e.json();s.user&&"admin"===s.user.role?(g(s.user),await L(),await F()):P.push("/login")}catch(e){console.error("Error fetching data:",e),O(e.message)}finally{R(!1)}}()},[P]);let z=async e=>{e.preventDefault();try{let e=await fetch("/api/admin/authorized-users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({steamId:y,role:b})});if(e.ok)await L(),w(""),E("user"),s({title:"Success",description:"User added successfully"});else{let s=await e.json();throw Error(s.message||"Failed to add user")}}catch(e){console.error("Error adding user:",e),s({title:"Error",description:e.message,variant:"destructive"})}},q=async e=>{try{let a=await fetch("/api/admin/authorized-users?steamId=".concat(e),{method:"DELETE"});if(a.ok)await L(),s({title:"Success",description:"User removed successfully"});else{let e=await a.json();throw Error(e.message||"Failed to remove user")}}catch(e){console.error("Error removing user:",e),s({title:"Error",description:e.message,variant:"destructive"})}},M=async(e,a)=>{try{let r=await fetch("/api/admin/authorized-users",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({steamId:e,role:a})});if(r.ok)await L(),s({title:"Success",description:"User role updated successfully"});else{let e=await r.json();throw Error(e.message||"Failed to update user role")}}catch(e){console.error("Error updating user role:",e),s({title:"Error",description:e.message,variant:"destructive"})}},D=(e,s)=>{T(a=>({...a,[e]:s}))},G=async e=>{try{let a=A[e];"SERVER_OPTIONS"===e&&(a=JSON.stringify(a));let r=await fetch("/api/admin/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:e,value:a})});if(r.ok)await F(),s({title:"Success",description:"".concat(e," updated successfully")});else{let e=await r.json();throw Error(e.message||"Failed to update configuration")}}catch(e){console.error("Error updating configuration:",e),s({title:"Error",description:e.message,variant:"destructive"})}},$=e=>{T(s=>({...s,SERVER_OPTIONS:s.SERVER_OPTIONS.filter((s,a)=>a!==e)}))},B=(e,s,a)=>{T(r=>({...r,SERVER_OPTIONS:r.SERVER_OPTIONS.map((r,t)=>t===e?{...r,[s]:a}:r)}))};return S?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,r.jsx)(u.A,{className:"h-8 w-8 animate-spin text-primary"})}):_?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,r.jsxs)("div",{className:"text-lg text-destructive",children:["Error: ",_]})}):a?(0,r.jsxs)("div",{className:"min-h-screen flex flex-col bg-background text-foreground",children:[(0,r.jsx)(i.A,{}),(0,r.jsx)("div",{className:"container mx-auto px-4 py-24 flex-1",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto bg-card rounded-lg shadow-md p-7 mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 mb-6",children:[(0,r.jsxs)(d.eu,{className:"h-16 w-16",children:[(0,r.jsx)(d.BK,{src:a.avatarUrl||"/placeholder-avatar.png",alt:"User Avatar"}),(0,r.jsx)(d.q5,{children:(null===(e=a.displayName)||void 0===e?void 0:e.charAt(0))||"U"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:a.displayName||"User"}),(0,r.jsxs)("p",{className:"text-muted-foreground",children:["(",a.steamId64,")"]})]})]}),(0,r.jsx)("hr",{className:"border-b border-border my-4"}),"admin"===a.role&&(0,r.jsxs)(x.tU,{defaultValue:"users",children:[(0,r.jsxs)(x.j7,{className:"grid w-full grid-cols-2",children:[(0,r.jsx)(x.Xi,{value:"users",children:"Authorized Users"}),(0,r.jsx)(x.Xi,{value:"config",children:"Configuration"})]}),(0,r.jsxs)(x.av,{value:"users",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Authorized Users"}),j.length>0?(0,r.jsx)("ul",{className:"mb-6 space-y-2",children:j.map(e=>{var s,a,t,l;return(0,r.jsxs)("li",{className:"flex justify-between items-center p-2 bg-accent rounded",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)(d.eu,{className:"h-10 w-10",children:[(0,r.jsx)(d.BK,{src:(null===(s=U[e.steam_id])||void 0===s?void 0:s.avatarUrl)||"/placeholder-avatar.png",alt:"".concat((null===(a=U[e.steam_id])||void 0===a?void 0:a.displayName)||"User","'s avatar")}),(0,r.jsx)(d.q5,{children:((null===(t=U[e.steam_id])||void 0===t?void 0:t.displayName)||"U").charAt(0)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:(null===(l=U[e.steam_id])||void 0===l?void 0:l.displayName)||"Unknown User"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:e.steam_id})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)(o.l6,{value:e.role,onValueChange:s=>M(e.steam_id,s),children:[(0,r.jsx)(o.bq,{className:"w-[100px]",children:(0,r.jsx)(o.yv,{placeholder:"Select role"})}),(0,r.jsxs)(o.gC,{children:[(0,r.jsx)(o.eb,{value:"user",children:"User"}),(0,r.jsx)(o.eb,{value:"admin",children:"Admin"})]})]}),(0,r.jsx)(n.$,{onClick:()=>q(e.steam_id),variant:"destructive",size:"sm",children:"Remove"})]})]},e.steam_id)})}):(0,r.jsx)("p",{className:"mb-4",children:"No authorized users found."}),(0,r.jsxs)("form",{onSubmit:z,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(c.p,{type:"text",value:y,onChange:e=>w(e.target.value),placeholder:"Enter SteamID64",className:"flex-grow",required:!0}),(0,r.jsxs)(o.l6,{value:b,onValueChange:E,children:[(0,r.jsx)(o.bq,{className:"w-[100px]",children:(0,r.jsx)(o.yv,{placeholder:"Role"})}),(0,r.jsxs)(o.gC,{children:[(0,r.jsx)(o.eb,{value:"user",children:"User"}),(0,r.jsx)(o.eb,{value:"admin",children:"Admin"})]})]})]}),(0,r.jsx)(n.$,{type:"submit",className:"w-full",children:"Add User"})]})]}),(0,r.jsxs)(x.av,{value:"config",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Configuration"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"imageUrl",className:"block text-sm font-medium text-gray-700 mb-1",children:"Image URL"}),(0,r.jsx)(c.p,{id:"imageUrl",type:"text",value:A.IMAGE_URL,onChange:e=>D("IMAGE_URL",e.target.value),placeholder:"Enter image URL",className:"w-full"}),(0,r.jsx)(n.$,{onClick:()=>G("IMAGE_URL"),className:"w-full mt-2",children:"Update Image URL"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Server Options (Format: NAME | SERVER ID)"}),(0,r.jsx)(p.Zp,{children:(0,r.jsxs)(p.Wu,{className:"pt-6",children:[A.SERVER_OPTIONS.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)(c.p,{type:"text",value:e.label,onChange:e=>B(s,"label",e.target.value),placeholder:"Server Name (e.g. RETAKE #1)",className:"flex-grow"}),(0,r.jsx)(c.p,{type:"text",value:e.value,onChange:e=>B(s,"value",e.target.value),placeholder:"Server ID (e.g. 1)",className:"flex-grow"}),(0,r.jsx)(n.$,{onClick:()=>$(s),variant:"destructive",size:"icon",children:(0,r.jsx)(m.A,{className:"h-4 w-4"})})]},s)),(0,r.jsxs)(n.$,{onClick:()=>{T(e=>({...e,SERVER_OPTIONS:[...e.SERVER_OPTIONS,{label:"",value:""}]}))},variant:"outline",className:"w-full mt-2",children:[(0,r.jsx)(h.A,{className:"mr-2 h-4 w-4"})," Add Server Option"]})]})}),(0,r.jsx)(n.$,{onClick:()=>G("SERVER_OPTIONS"),className:"w-full mt-2",children:"Update Server Options"})]})]})]})]})]})}),(0,r.jsx)(f.A,{})]}):null}}},e=>{var s=s=>e(e.s=s);e.O(0,[886,136,411,912,636,593,792],()=>s(4258)),_N_E=e.O()}]);