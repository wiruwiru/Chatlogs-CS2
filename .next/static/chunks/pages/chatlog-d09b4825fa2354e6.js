(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[212],{2622:(e,a,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/chatlog",function(){return r(8970)}])},8353:(e,a,r)=>{"use strict";r.d(a,{BK:()=>d,eu:()=>o,q5:()=>c});var t=r(4848),s=r(6540),n=r(5847),l=r(9751);let o=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)(n.bL,{ref:a,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...s})});o.displayName=n.bL.displayName;let d=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)(n._V,{ref:a,className:(0,l.cn)("aspect-square h-full w-full",r),...s})});d.displayName=n._V.displayName;let c=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)(n.H4,{ref:a,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...s})});c.displayName=n.H4.displayName},197:(e,a,r)=>{"use strict";r.d(a,{S:()=>f});var t=r(4848),s=r(6540),n=r(9611),l=r(9096),o=r(9751),d=r(5126),c=r(9242),i=r(7049);function u(e){let{className:a,classNames:r,showOutsideDays:s=!0,...n}=e;return(0,t.jsx)(c.hv,{showOutsideDays:s,className:(0,o.cn)("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,o.cn)((0,d.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:(0,o.cn)("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md","range"===n.mode?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:(0,o.cn)((0,d.r)({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},components:{IconLeft:e=>{let{className:a,...r}=e;return(0,t.jsx)(i.YJP,{className:(0,o.cn)("h-4 w-4",a),...r})},IconRight:e=>{let{className:a,...r}=e;return(0,t.jsx)(i.vKP,{className:(0,o.cn)("h-4 w-4",a),...r})}},...n})}u.displayName="Calendar";var m=r(9823);let h=m.bL,g=m.l9;m.Mz;let x=s.forwardRef((e,a)=>{let{className:r,align:s="center",sideOffset:n=4,...l}=e;return(0,t.jsx)(m.ZL,{children:(0,t.jsx)(m.UC,{ref:a,align:s,sideOffset:n,className:(0,o.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...l})})});function f(e){let{className:a,value:r,onChange:s}=e;return(0,t.jsx)("div",{className:(0,o.cn)("grid gap-2",a),children:(0,t.jsxs)(h,{children:[(0,t.jsx)(g,{asChild:!0,children:(0,t.jsxs)(d.$,{id:"date",variant:"outline",className:(0,o.cn)("w-full justify-start text-left font-normal",!r&&"text-muted-foreground","bg-secondary text-foreground border-input hover:bg-background hover:text-accent-foreground"),children:[(0,t.jsx)(l.A,{className:"mr-2 h-4 w-4"}),(null==r?void 0:r.from)?r.to?(0,t.jsxs)(t.Fragment,{children:[(0,n.GP)(r.from,"LLL dd, y")," -"," ",(0,n.GP)(r.to,"LLL dd, y")]}):(0,n.GP)(r.from,"LLL dd, y"):(0,t.jsx)("span",{children:"Pick a date range"})]})}),(0,t.jsx)(x,{className:"w-auto p-0",align:"start",children:(0,t.jsx)(u,{initialFocus:!0,mode:"range",defaultMonth:null==r?void 0:r.from,selected:r,onSelect:s,numberOfMonths:2,className:"bg-background text-foreground border-border"})})]})})}x.displayName=m.UC.displayName},8718:(e,a,r)=>{"use strict";r.d(a,{Eb:()=>m,Iu:()=>c,M_:()=>g,WA:()=>h,cU:()=>i,dK:()=>d,n$:()=>u});var t=r(4848),s=r(6540),n=r(9751),l=r(5126),o=r(7049);let d=e=>{let{className:a,...r}=e;return(0,t.jsx)("nav",{role:"navigation","aria-label":"pagination",className:(0,n.cn)("mx-auto flex w-full justify-center",a),...r})};d.displayName="Pagination";let c=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)("ul",{ref:a,className:(0,n.cn)("flex flex-row items-center gap-1",r),...s})});c.displayName="PaginationContent";let i=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)("li",{ref:a,className:(0,n.cn)("",r),...s})});i.displayName="PaginationItem";let u=e=>{let{className:a,isActive:r,size:s="icon",...o}=e;return(0,t.jsx)("a",{"aria-current":r?"page":void 0,className:(0,n.cn)((0,l.r)({variant:r?"outline":"ghost",size:s}),a),...o})};u.displayName="PaginationLink";let m=e=>{let{className:a,...r}=e;return(0,t.jsxs)(u,{"aria-label":"Go to previous page",size:"default",className:(0,n.cn)("gap-1 pl-2.5",a),...r,children:[(0,t.jsx)(o.YJP,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Previous"})]})};m.displayName="PaginationPrevious";let h=e=>{let{className:a,...r}=e;return(0,t.jsxs)(u,{"aria-label":"Go to next page",size:"default",className:(0,n.cn)("gap-1 pr-2.5",a),...r,children:[(0,t.jsx)("span",{children:"Next"}),(0,t.jsx)(o.vKP,{className:"h-4 w-4"})]})};h.displayName="PaginationNext";let g=e=>{let{className:a,...r}=e;return(0,t.jsxs)("span",{"aria-hidden":!0,className:(0,n.cn)("flex h-9 w-9 items-center justify-center",a),...r,children:[(0,t.jsx)(o.Oer,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"More pages"})]})};g.displayName="PaginationEllipsis"},4111:(e,a,r)=>{"use strict";r.d(a,{T:()=>l});var t=r(4848),s=r(6540),n=r(8718);function l(e){let{currentPage:a,totalPages:r,onPageChange:l,className:o}=e,d=!function(e){let[a,r]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let t=window.matchMedia(e);t.matches!==a&&r(t.matches);let s=()=>r(t.matches);return t.addEventListener("change",s),()=>t.removeEventListener("change",s)},[a,e]),a}("(max-width: 640px)")?5:3;return(0,t.jsx)(n.dK,{className:o,children:(0,t.jsxs)(n.Iu,{className:"gap-1",children:[(0,t.jsx)(n.cU,{children:(0,t.jsx)(n.Eb,{onClick:()=>l(Math.max(1,a-1)),className:"h-8 bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",disabled:1===a})}),(()=>{let e=[],s=Math.max(1,a-Math.floor(d/2)),o=Math.min(r,s+d-1);o-s+1<d&&(s=Math.max(1,o-d+1)),s>1&&(e.push((0,t.jsx)(n.cU,{children:(0,t.jsx)(n.n$,{onClick:()=>l(1),className:"bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",children:"1"})},"start")),s>2&&e.push((0,t.jsx)(n.cU,{children:(0,t.jsx)(n.M_,{className:"bg-background text-foreground border-border"})},"start-ellipsis")));for(let r=s;r<=o;r++)e.push((0,t.jsx)(n.cU,{children:(0,t.jsx)(n.n$,{onClick:()=>l(r),isActive:a===r,className:a===r?"bg-accent text-accent-foreground border-border":"bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",children:r})},r));return o<r&&(o<r-1&&e.push((0,t.jsx)(n.cU,{children:(0,t.jsx)(n.M_,{className:"bg-background text-foreground border-border"})},"end-ellipsis")),e.push((0,t.jsx)(n.cU,{children:(0,t.jsx)(n.n$,{onClick:()=>l(r),className:"bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",children:r})},"end"))),e})(),(0,t.jsx)(n.cU,{children:(0,t.jsx)(n.WA,{onClick:()=>l(Math.min(r,a+1)),className:"h-8 bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",disabled:a===r})})]})})}},8970:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>j});var t=r(4848),s=r(6540),n=r(6715),l=r(4862),o=r(6424),d=r(8435),c=r(172),i=r(8353),u=r(778),m=r(3761),h=r(9893),g=r(2955),x=r(5126),f=r(197),p=r(4111),b=r(2510);function v(){let{toast:e}=(0,b.dj)(),a=(0,o.useRouter)(),r=(0,o.useSearchParams)(),n=r.get("page"),[l,v]=(0,s.useState)([]),[j,N]=(0,s.useState)("all"),[y,w]=(0,s.useState)(""),[S,_]=(0,s.useState)("all"),[k,P]=(0,s.useState)(""),[E,C]=(0,s.useState)(n?parseInt(n):1),[L,I]=(0,s.useState)(1),[M,U]=(0,s.useState)(!1),[R,O]=(0,s.useState)(!0),[A,F]=(0,s.useState)({}),[T,z]=(0,s.useState)(void 0),[G,K]=(0,s.useState)([]),$=async()=>{try{let e=await fetch("/api/admin/config"),a=await e.json(),r=JSON.parse(a.SERVER_OPTIONS||"[]");K(r)}catch(a){console.error("Error fetching server options:",a),e({title:"Error",description:"Failed to load server options",variant:"destructive"})}},q=async a=>{try{let e=await fetch("/api/steam/profiles?ids=".concat(a.join(",")));if(!e.ok)throw Error("Failed to fetch Steam profiles");let r=await e.json();F(e=>({...e,...r}))}catch(a){console.error("Error fetching Steam profiles:",a),e({title:"Error",description:"Failed to load Steam profiles",variant:"destructive"})}},V=(0,s.useCallback)(async a=>{U(!0);try{let e=new URLSearchParams({page:a.toString(),..."all"!==j&&{serverId:j},...y&&{steamIdNameIpFilter:y},..."all"!==S&&{team:S},...k&&{message:k},...(null==T?void 0:T.from)&&{fromDate:T.from.toISOString()},...(null==T?void 0:T.to)&&{toDate:T.to.toISOString()}}),r=await fetch("/api/chatlogs/chatcstwo?".concat(e));if(!r.ok)throw Error("Failed to fetch messages");let t=await r.json();v(t.items),I(t.totalPages);let s=[...new Set(t.items.map(e=>e.playerSteam64))];s.length>0&&q(s)}catch(a){console.error("Error fetching messages:",a),e({title:"Error",description:"Failed to load messages",variant:"destructive"})}finally{U(!1)}},[j,y,S,k,T]);(0,s.useEffect)(()=>{$()},[]),(0,s.useEffect)(()=>{C(1),V(1)},[j,y,S,k,T,V]),(0,s.useEffect)(()=>{let e=r.get("page");e&&C(parseInt(e)),V(E)},[r,E,V]);let D=e=>{switch(e.toString()){case"0":return"bg-red-500";case"1":return"bg-blue-500";default:return"bg-gray-500"}},B=e=>{switch(e.toString()){case"0":return"Global";case"1":return"Team";default:return"Unknown"}};return(0,t.jsxs)(c.Zp,{className:"max-w-6xl mx-auto bg-background shadow-lg border-border",children:[(0,t.jsxs)(c.aR,{className:"flex flex-row items-center justify-between border-b border-border",children:[(0,t.jsx)(c.ZB,{className:"text-foreground text-2xl font-bold",children:"Chat Logs"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(x.$,{onClick:()=>{V(E)},variant:"outline",size:"icon",className:"bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",children:(0,t.jsx)(m.A,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>O(!R),className:"p-2 hover:bg-background rounded-full transition-colors",children:(0,t.jsx)(h.A,{className:"h-5 w-5 text-foreground"})})]})]}),(0,t.jsxs)(c.Wu,{className:"p-4",children:[R&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,t.jsxs)(u.l6,{value:j,onValueChange:N,children:[(0,t.jsx)(u.bq,{className:"bg-secondary text-foreground border-input",children:(0,t.jsx)(u.yv,{placeholder:"Select Server"})}),(0,t.jsxs)(u.gC,{className:"bg-background border-border",children:[(0,t.jsx)(u.eb,{value:"all",className:"text-foreground",children:"All Servers"}),G.map(e=>(0,t.jsx)(u.eb,{value:e.value,className:"text-foreground",children:e.label},e.value))]})]}),(0,t.jsxs)(u.l6,{value:S,onValueChange:_,children:[(0,t.jsx)(u.bq,{className:"bg-secondary text-foreground border-input",children:(0,t.jsx)(u.yv,{placeholder:"Select Team"})}),(0,t.jsx)(u.gC,{className:"bg-background border-border",children:[{value:"all",label:"All Chats"},{value:"0",label:"Global Message"},{value:"1",label:"Team Message"}].map(e=>(0,t.jsx)(u.eb,{value:e.value,className:"text-foreground",children:e.label},e.value))})]}),(0,t.jsx)(f.S,{value:T,onChange:e=>{z(e),C(1),V(1)},className:"col-span-1"}),(0,t.jsx)(d.p,{placeholder:"Filter by Steam ID, Name, or IP",value:y,onChange:e=>w(e.target.value),className:"bg-secondary text-foreground border-input col-span-1"}),(0,t.jsx)(d.p,{placeholder:"Filter by Message",value:k,onChange:e=>P(e.target.value),className:"bg-secondary text-foreground border-input col-span-2"})]}),(0,t.jsx)("div",{className:"space-y-4",children:M?(0,t.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,t.jsx)(g.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):l.map((e,a)=>{var r,s,n;return(0,t.jsx)("div",{className:"flex ".concat(a%2==0?"justify-start":"justify-end"),children:(0,t.jsxs)("div",{className:"flex items-start space-x-2 max-w-[80%] ".concat(a%2==0?"flex-row":"flex-row-reverse"),children:[(0,t.jsx)(i.eu,{className:"h-10 w-10 border border-border",children:(0,t.jsxs)("a",{href:"/chatlog/".concat(e.playerSteam64),target:"_blank",rel:"noopener noreferrer",children:[(0,t.jsx)(i.BK,{src:null===(r=A[e.playerSteam64])||void 0===r?void 0:r.avatarUrl,alt:e.playerName}),(0,t.jsx)(i.q5,{className:"bg-foreground text-muted-foreground",children:e.playerName.slice(0,2)})]})}),(0,t.jsxs)("div",{className:"flex flex-col ".concat(a%2==0?"items-start":"items-end"),children:[(0,t.jsx)("span",{className:"font-medium text-sm text-foreground",children:(0,t.jsx)("a",{href:"/chatlog/".concat(e.playerSteam64),target:"_blank",rel:"noopener noreferrer",children:(null===(s=A[e.playerSteam64])||void 0===s?void 0:s.displayName)||e.playerName})}),(0,t.jsx)("div",{className:"mt-1 rounded-lg p-3 shadow-sm ".concat(D(e.team)," text-white"),children:(0,t.jsx)("p",{className:"text-sm",children:e.message})}),(0,t.jsxs)("div",{className:"mt-1 flex items-center space-x-2 text-xs text-muted-foreground",children:[(0,t.jsx)("span",{children:B(e.team)}),(0,t.jsx)("span",{children:(null===(n=G.find(a=>a.value===e.serverId))||void 0===n?void 0:n.label)||"Unknown"}),(0,t.jsx)("span",{children:e.created}),(0,t.jsxs)("span",{children:["IP: ",e.lastIP||"Unknown"]})]})]})]})},e.id)})}),(0,t.jsx)(p.T,{currentPage:E,totalPages:L,onPageChange:e=>{C(e),a.push("/chatlog?page=".concat(e),void 0,{shallow:!0}),window.scrollTo(0,0)},className:"mt-6"})]})]})}function j(){let[e,a]=(0,s.useState)(null),[r,o]=(0,s.useState)(!0),d=(0,n.useRouter)();return((0,s.useEffect)(()=>{(async function(){try{let e=await fetch("/api/auth/session"),r=await e.json();r.user?a(r.user):d.push("/login")}catch(e){console.error("Error fetching user:",e),d.push("/login")}finally{o(!1)}})()},[d]),r)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,t.jsx)("div",{className:"text-2xl font-semibold text-foreground",children:"Loading..."})}):e?(0,t.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,t.jsx)(l.A,{}),(0,t.jsx)("div",{className:"p-8",children:(0,t.jsx)(v,{})})]}):null}}},e=>{var a=a=>e(e.s=a);e.O(0,[886,136,702,912,636,593,792],()=>a(2622)),_N_E=e.O()}]);